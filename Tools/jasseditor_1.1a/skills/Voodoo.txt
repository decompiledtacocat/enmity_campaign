function VoodooConditions  takes nothing returns boolean
return ( GetSpellAbilityId() == 'A09Z' )
endfunction
function VoodooActions takes nothing returns nothing
    local unit vcaster=GetSpellAbilityUnit()
    local unit vtarget=GetSpellTargetUnit()
    local effect voodoofx
    local real vdmg
    local integer voodoolevel=GetUnitAbilityLevelSwapped('A09Z',vcaster)
    local real vtime=GetRandomReal(1.00, 6.00)
    call SetUnitAnimation( vcaster, "stand hit" )
    call AddSpecialEffectTargetUnitBJ( "overhead", vcaster, "Objects\\Spawnmodels\\Human\\HumanBlood\\BloodElfSpellThiefBlood.mdl" )
    set voodoofx=GetLastCreatedEffectBJ()
    call PlaySoundOnUnitBJ(gg_snd_MetalHeavySliceFlesh2, 100, vcaster )
    call KillSoundWhenDone(GetLastPlayedSound())
    call PolledWait(vtime)
    call SetUnitAnimation( vtarget, "stand hit" )
    call DestroyEffect (voodoofx)
    call PlaySoundOnUnitBJ(gg_snd_MetalHeavySliceFlesh2, 100, vtarget )
    call KillSoundWhenDone(GetLastPlayedSound())
    call AddSpecialEffectTargetUnitBJ( "overhead", vtarget, "Objects\\Spawnmodels\\Undead\\UndeadBlood\\UndeadBloodAbomination.mdl" )
    set voodoofx=GetLastCreatedEffectBJ()
    if (  UnitHasBuffBJ(vtarget, 'B01H') == true  ) then
    set vdmg =( 90.00 * I2R(voodoolevel))
    else
    set vdmg =( 60.00 * I2R(voodoolevel))      
    endif
    set udg_tempecheckunit=null
    set udg_tempecheckunit=vtarget
    if ( etherealcheck() ) then
      call UnitDamageTargetBJ(vcaster,vtarget, vdmg , ATTACK_TYPE_MAGIC, DAMAGE_TYPE_NORMAL )
     else
      call UnitDamageTargetBJ(vcaster,vtarget,vdmg , ATTACK_TYPE_PIERCE, DAMAGE_TYPE_NORMAL )
    endif
   call UnitRemoveBuffBJ( 'B01F', vtarget)
   set vtarget=null
   set vcaster=null
   call TriggerSleepAction(1.00)
   call DestroyEffect (voodoofx)
endfunction
//===========================================================================
function InitTrig_Voodoo takes nothing returns nothing
    set gg_trg_Voodoo = CreateTrigger(  )
    call TriggerRegisterAnyUnitEventBJ( gg_trg_Voodoo, EVENT_PLAYER_UNIT_SPELL_EFFECT )
    call TriggerAddCondition( gg_trg_Voodoo, Condition( function VoodooConditions) )
    call TriggerAddAction( gg_trg_Voodoo, function VoodooActions)
endfunction
