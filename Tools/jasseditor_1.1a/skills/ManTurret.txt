function ManTurretConditions takes nothing returns boolean
return GetBooleanAnd(GetBooleanAnd(( IsUnitIllusionBJ(GetEnteringUnit()) == false ), ( IsUnitType(GetEnteringUnit(), UNIT_TYPE_HERO) == true )),( IsUnitAlly(GetEnteringUnit(), Player(0)) == true ))
endfunction
function ManTurretFilter  takes nothing returns boolean
return  GetBooleanAnd((GetOwningPlayer(GetFilterUnit()) == Player(PLAYER_NEUTRAL_PASSIVE) ),GetBooleanOr(( GetUnitTypeId(GetFilterUnit()) == 'h00K' ),( GetUnitTypeId(GetFilterUnit()) == 'h00J' )) )
endfunction
function ManTurretActions takes nothing returns nothing
    local unit pickedunit
    local unit enteringunit=GetEnteringUnit()
    local player mplayer=GetOwningPlayer(enteringunit)
    local rect entered
    local group turretgroup
   if  RectContainsUnit(gg_rct_Turret1,enteringunit) then
     set entered=gg_rct_Turret1
   elseif RectContainsUnit(gg_rct_Turret2,enteringunit) then
     set entered=gg_rct_Turret2
   elseif RectContainsUnit(gg_rct_Turret3,enteringunit) then
     set entered=gg_rct_Turret3
   elseif RectContainsUnit(gg_rct_Turret4,enteringunit) then
     set entered=gg_rct_Turret4
   elseif RectContainsUnit(gg_rct_Turret5,enteringunit) then
     set entered=gg_rct_Turret5
   elseif RectContainsUnit(gg_rct_Turret6,enteringunit) then
     set entered=gg_rct_Turret6
   elseif RectContainsUnit(gg_rct_Turret7,enteringunit) then
     set entered=gg_rct_Turret7
   elseif RectContainsUnit(gg_rct_Turret8,enteringunit) then
     set entered=gg_rct_Turret8
   elseif RectContainsUnit(gg_rct_Turret9,enteringunit) then
     set entered=gg_rct_Turret9
   elseif RectContainsUnit(gg_rct_Turret10,enteringunit) then
     set entered=gg_rct_Turret10
   elseif RectContainsUnit(gg_rct_Turret11,enteringunit) then
     set entered=gg_rct_Turret11
   elseif RectContainsUnit(gg_rct_Turret12,enteringunit) then
     set entered=gg_rct_Turret12  
   elseif RectContainsUnit(gg_rct_Turret13,enteringunit) then
     set entered=gg_rct_Turret13    
   elseif RectContainsUnit(gg_rct_Turret14,enteringunit) then
     set entered=gg_rct_Turret14    
   elseif RectContainsUnit(gg_rct_Turret15,enteringunit) then
     set entered=gg_rct_Turret15    
   elseif RectContainsUnit(gg_rct_Turret16,enteringunit) then
     set entered=gg_rct_Turret16    
   endif
set turretgroup=GetUnitsInRectMatching(entered, Condition(function ManTurretFilter))
set pickedunit=FirstOfGroup(turretgroup)
call DestroyGroup(turretgroup)
set turretgroup=null
if pickedunit!=null then
call SetUnitOwner(pickedunit, mplayer, true )
loop
exitwhen (RectContainsUnit(entered,enteringunit)==false)
call TriggerSleepAction(1.0)
endloop
call SetUnitOwner(pickedunit, Player(PLAYER_NEUTRAL_PASSIVE), true )
endif
set pickedunit=null
set enteringunit=null
set mplayer =null
endfunction
//===========================================================================
function InitTrig_ManTurret takes nothing returns nothing
    set gg_trg_ManTurret = CreateTrigger(  )
    call TriggerRegisterEnterRectSimple( gg_trg_ManTurret, gg_rct_Turret1)
    call TriggerRegisterEnterRectSimple( gg_trg_ManTurret, gg_rct_Turret2)
    call TriggerRegisterEnterRectSimple( gg_trg_ManTurret, gg_rct_Turret3)
    call TriggerRegisterEnterRectSimple( gg_trg_ManTurret, gg_rct_Turret4)
    call TriggerRegisterEnterRectSimple( gg_trg_ManTurret, gg_rct_Turret5)
    call TriggerRegisterEnterRectSimple( gg_trg_ManTurret, gg_rct_Turret6)
    call TriggerRegisterEnterRectSimple( gg_trg_ManTurret, gg_rct_Turret7)
    call TriggerRegisterEnterRectSimple( gg_trg_ManTurret, gg_rct_Turret8)
    call TriggerRegisterEnterRectSimple( gg_trg_ManTurret, gg_rct_Turret9)
    call TriggerRegisterEnterRectSimple( gg_trg_ManTurret, gg_rct_Turret10)
    call TriggerRegisterEnterRectSimple( gg_trg_ManTurret, gg_rct_Turret11)
    call TriggerRegisterEnterRectSimple( gg_trg_ManTurret, gg_rct_Turret12)
    call TriggerRegisterEnterRectSimple( gg_trg_ManTurret, gg_rct_Turret13)
    call TriggerRegisterEnterRectSimple( gg_trg_ManTurret, gg_rct_Turret14)
    call TriggerRegisterEnterRectSimple( gg_trg_ManTurret, gg_rct_Turret15)
    call TriggerRegisterEnterRectSimple( gg_trg_ManTurret, gg_rct_Turret16)
    call TriggerAddCondition( gg_trg_ManTurret, Condition( function ManTurretConditions  ) )
    call TriggerAddAction( gg_trg_ManTurret, function ManTurretActions  )
endfunction

